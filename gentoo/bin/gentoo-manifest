#!/bin/bash

manifest() {
    declare t x
    for x; do
        case /$x in
            */Manifest) continue ;;
            */*.ebuild) t=EBUILD ;;
            */ChangeLog) t=MISC ;;
            */metadata.xml) t=MISC ;;
            */files/*) t=AUX ;;
            *) t=DIST ;;
        esac
        printf "$t %s %s RMD160 %s SHA1 %s SHA256 %s\n" \
            "${x##*/}" `stat -c %s $x` \
            `openssl dgst -ripemd160 $x | awk '{print $NF}'` \
            `openssl dgst -sha1      $x | awk '{print $NF}'` \
            `openssl dgst -sha256    $x | awk '{print $NF}'`
    done
}

# this isn't space-safe
set -- $(find "$@" -type f)
manifest "$@"
